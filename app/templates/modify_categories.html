{% extends 'base.html' %}
  
{% block page %}


{% if old_category_name is None %}

	<h2>Add category:</h2>
	<form method="post" action="{% url 'modify_categories' %}">
		{% csrf_token %}
		{{ categoryform }}
		<button type="submit">Save</button>
	</form>

{% else %}

	<!-- This form will appear only if category name is edited-->
	<h2>Change category name:</h2>
	<form method="post" action="{% url 'edit_category' %}">
		{% csrf_token %}
		{{ categoryform }}
		<input type="hidden" name="category_id" value="{{ category_id }}" />
		<button type="submit">Save new name</button>
	</form>

{% endif %}


<h2>Edit category:</h2>
<b>Deleting category will delete all logs with this category !</b>
<table class='table table-hover table-responsive table-striped'>
	<tr class="info">
			<td>Category</td>
			<td>Delete</td>
			<td>Edit name</td>
			<td>Set Default</td>
	</tr>



	{% for category in categories %}   <!--  Table with categories, category.0 is id, category.1 is name-->
		<tr>

			<td>				
				{% if category.0 == login.profile.default_category.id %}
				<span class="label label-primary">DEFAULT</span></br>
				{% endif %}
				{{ category.1 }}
			</td>
			
			<td>
				<form method="post" action="{% url 'delete_category' %}">
					{% csrf_token %}	
					<input type="hidden" name="category_id" value="{{ category.0 }}" />
					<button class="btn btn-danger" type="submit">Delete</button>
				</form>
			</td>

			<td>
				<button class="btn btn-info" type="button">
					<a href="{% url 'edit_category' %}/{{ category.0 }}">Edit name</a>
				</button>
			</td>

			<td>
				<form method="post" action="{% url 'set_default_category' %}">
					{% csrf_token %}	
					<input type="hidden" name="category_id" value="{{ category.0 }}" />
					<button class="btn btn-info" type="submit">Set Default</button>
				</form>
			</td>
				
		</tr>
	{% endfor %}

		<tr>		 <!--  Works as footer -->
			<td></td>
			<td></td>
			<td></td>
			<td>
				<form method="post" action="{% url 'set_default_category' %}">
					{% csrf_token %}	
					<input type="hidden" name="category_id" value="remove_default"/>
					<button class="btn btn-info" type="submit">Remove Default</button>
				</form>
			</td>	
		</tr>




</table>


{% endblock %}