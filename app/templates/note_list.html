{% extends 'base.html' %}

{% block page %}

<div >
    {% block add_note %}
    {% endblock %}
</div>

<h2>Show journal:</h2>
<!-- ################################ FILTER  -->
<script>
//auto submits filter form
$(document).ready(function(){  
    $(".auto-submit").change(function() {
        $(this).closest("form").submit();
    });
});
</script>
<div>
  <form method="post" action="{% url 'index' %}">
	<div class="auto-submit">
		{% csrf_token %}
		{{ filterform }}
	</div>
  </form>
</div>


<!-- ################################ JOURNAL  -->
<table class='table table-hover table-responsive table-striped'>
	<tr class="info">
		<td>Date</td>
		<td>Value</td>
		<td>Category</td>
		<td>Description</td>
		<td>Action</td>
		<td></td>
	</tr>

	{% for note in all_records %}
	<tr>
			<td>{{ note.date }}</td>
			<td>{{ note.value }}</td>
			<td>{{ note.category }}</td>
			<td>{{ note.description }}</td>				
			<td>
				<form method="post" action="{% url 'deletenote' %}">
					{% csrf_token %}	
					<input type="hidden" name="id" value="{{ note.id }}" />
					<input type="hidden" name="startdate" value="{{ filter.startdate }}" />
					<input type="hidden" name="stopdate" value="{{ filter.stopdate }}" />
					<input type="hidden" name="category" value="{{ filter.category }}" />
					<button class="btn btn-danger" type="submit">Delete</button>
				</form>
			</td>
			<td>
				<button class="btn btn-info" type="button">
					<a href="{% url 'edit_note' %}/{{ note.id }}">Edit</a>
				</button>
			</td>			
	</tr>
	{% endfor %} 
</table>

<!-- ################################ SUMMARY  -->
</br></br>

<table class='table'>
	<tr>
		<td>Sum:</td>
		<td>{{ summary }}</td>		
	</tr>
</table>

</br></br>

<!-- ################################ OPTIONS  -->
<table class='table-borderless'>
	<tr>
		<td><h1>Options:</h1></td>
	</tr>
	<tr>
		<td><a href="{% url 'modify_categories' %}">Modify categories</a></td>
	</tr>
	<tr>	
		<td><a href="{% url 'export' %}">Export (all data) to csv</a></td>
	</tr>
	<tr>
		
	</tr>
</table>



<form method="post" action="{% url 'import' %}" enctype="multipart/form-data"></td>
{% csrf_token %}
{{ form.non_field_errors }}
{% for hidden_field in form.hidden_fields %}
	{{ hidden_field.errors }}
	{{ hidden_field }}
{% endfor %}

</br>


<div>		
	{{ import_form }}

	<input class="btn btn-default" type ="submit" value="Send">
</div>

</form>


{% endblock %}
